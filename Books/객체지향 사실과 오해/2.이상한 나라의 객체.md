---
tags:
  - 리팩토링
도서명: 객체지향의 사실과 오해
저자명: 조영호
---
객체지향 패러다임의 목적은 현실 세계 모방이 아닌 , 현실 세계 기반으로 새로운 세계를 창조하는 것
-> 전혀 다른 모습을 보이는 것 역시도 일반적

> 현실 세계의 전등은 사람 손길 없이 스스로 불을 발힐 수 없으나,
> 소프트웨어 세계의 전등은 외부 도움 없이 스스로 ON/OFF 가능

본질적으론 매우 이질적인 모습을 가지는 세계 - Like 이상한 나라의 앨리스

#### 앨리스 객체

앨리스의 키는 앨리스가 하는 <span style="color:#00b0f0">행동</span>에 따라 결국 변했다
-> 앨리스가 하는 행동에 따라 상태가 변함

상태를 결정하는 것은 행동이나 , 행동의 결과를 결정하는 것은 상태다 (??)

( 케이크를 먹거나 부채질 하기 전 , 앨리스 키가 얼마냐에 따라 , 행동 후의 키를 결정 )
-> 앨리스가 한 행동의 결과는 앨리스 상태에 의존적

( 문을 성공적 통과하기 위해서 충분히 몸을 작게 줄여야 함 )
-> 어떤 행동 성공 여부는 이전에 어떤 행동들이 발생한지에 영향을 받음
=> 행동 간 순서가 중요하다

그렇다고 커지거나 작아진 앨리스는 앨리스가 아닌가?
-> 앨리스는 유일 존재로 <span style="color:#fb3c3c">식별 가능</span> 
### 객체 , 소프트웨어 나라

객체를 상태 , 행동 , 식별자를 지닌 실체로 보는게 가장 효과적이다

> 객체란 식별 가능한 개체 or 사물이다.
> 구체적인 사물일 수도 , 추상적인 개념일 수도 있다
> 구별 가능 식별자 , 특정 행동 , 변경 가능 상태를 가진다
#### 상태

주변 환경 과 상호작용에 어떻게 반응하는가는
해당 시점까지 객체에 어떤 일이 발생했느냐에 좌우
( 여행을 위해 비행기를 이용하려면 탑승 전 항공권 발권! )

앨리스가 부채질을 하고 , 버섯 한쪽을 먹고 , 케이크를 먹고...
이 모든 과정과 결과를 기억할 필요가 있을까?
-> 행동의 이력을 통해 행동 결과를 판단하는 방식은 매우 복잡하고 번거로움
=> 단순하게 기술하기 위해 <span style="color:#00b0f0">상태</span>라는 개념이 나왔다!
( 앨리스의 키만 알면 OK )

>근본적으로 세상의 복잡성을 완화시키고 , 인지 과부하를 줄일 수 있는 중요한 개념
##### 프로퍼티

앨리스 , 버섯 , 부채 같은 것들은 모두 객체이다
-> 뚜렷한 경계를 가지고 + 식별 가능 + 상태와 행동을 지니기에

앨리스의 '키' , '위치' 같은것은 객체인가? ( 물론 , 극도의 객체지향적에서 객체긴 함 )

-> 숫자 , 문자열 , 양 , 속도 , 참/거짓 같은 단순 값들은 객체가 아님
( 객체의 상태를 표현하기 위한 중요한 수단 )

앨리스 와 움료를 표현한다면?

-> 앨리스 ( 키 = 130cm , 위치 = "통로" ) - 음료 ( 양 = 0.5l )

모든 객체의 상태는 단순한 값과 객체 조합으료 표현 가능!

키 , 위치 , 음료 같은것이 앨리스의 <span style="color:#fb3c3c">프로퍼티</span> 
( 프로퍼티는 고정되기에 ' 정적 ' )
( 프로퍼티 값은 시간 흐름에 따라 변하기에 ' 동적 ' )

- 앨리스 와 음료 사이 선 처럼 의미 있는 연결을 <span style="color:#00b0f0">링크</span> 라고 한다
( 링크가 있으면 협력이 가능하나 , 존재하지 않으면 협력 불가능 )

- 키 , 위치 같이 단순한 값은 <span style="color:#00b0f0">속성</span> 라고 한다

=> 프로퍼티는 ( 단순 값의 속성 + 다른 객체 가리키는 링크 ) 두 가지로 표현 가능

> 상태는 특정 시점 객체가 가지고 있는 정보 집합으로 객체 구조적 특징 표현
> 객체 상태는 정적인 프로퍼티 와 동적인 프로퍼티 값으로 구성
> 프로퍼티는 단순 값 과 다른 객체 참조하는 링크로 구분 가능

객체는 자율적인 존재이므로 다른 객체에 직접적 접근 , 상태 변경 불가능! ( 스스로가 책임져야함 )
=> 간접적으로 객체 상태 변경하게 가능하게 해주는 <span style="color:#00b050">행동</span> 등장!
##### 행동

객체의 상태는 저절로 변경되지 않는다
-> 상태 변경하는 것은 객체의 자발적 행동

엘리스가 키가 작아진 이유는?
-> 앨리스가 음료를 마셨기 때문

즉 , 객체가 취하는 행동은 객체 자신의 상태를 변경시킨다
-> 객체 행동에 의해 객체 상태가 변경된다는 것은 <span style="color:#fb3c3c">부수 효과</span> 를 초래하는 것

Side-effect 를 두려워 해야 하는 것은 맞으나 , 필연적인 것
( 앨리스가 케이크 먹어 , 키가 작아지고 + 케이크 양을 줄이는 것은 당연한 것 )

그렇기에 행동의 결과는 상태에 의존적
( 음료 케이크 먹은 후 , 키가 작아지려면 ? -> 앨리스의 키에 의존중 )
( 문을 연다면? -> 키가 문보다 크면 문을 열 수없다 )

- 객체의 행동은 상태에 영향을 받는다
- 객체의 행동은 상태를 변경시킨다
->
- 상호작용이 현재의 상태에 어떤 방식으로 의존하는가
- 상호작용이 어떻게 현재의 상태를 변경시키는가
###### 협력과 행동

객체는 섬이 아님
-> 객체는 자신에게 주어진 책임 완수를 위해 다른 객체를 이용하고 다른 객체에 서비스를 제공해줘야 한다
=> 객체의 행동은 객체가 협력에 참여할 수 있는 유일한 방법

객체는 협력에 참여하는 중 자기 자신 상태뿐만 아니라 , 다른 객체 상태 변경 유발도 가능
( 엘리스가 음료를 마신다면? -> 당연히 음료의 양도 줄어양 함 )

객체의 행동은 아래 두 가지 관점의 부수 효과를 명확히 서술해야 한다

- 객체 자신의 상태 변경
- 행동 내에서 협력하는 다른 객체 대한 메시지 전송

> 행동이란 외부 요청 or 수신된 메시지에 응답하기 위해 동작하고 반응하는 활동이다.
> 행동 결과로 객체는 자신의 상태를 변경하거나 다른 객체에 메시지 전달할 수 있다
> 객체 행동을 통해 다른 객체와 협력에 참여하므로 , 행동은 외부에 가시적이어야 한다.
###### 상태 캡슐화

현실 세계 객체와 객체지향 세계의 객체 사이는 중요한 차이점이 있다

현실 속 앨리스는 스스로 음료수를 마시는 자연스러운 능동적 존재이지만
음료수는 스스로 아무것도 할 수 없는 수동적 존재이다
-> 음료 양을 줄이고 상태 변경시키는 주체는 음료를 목 안에 넣은 앨리스가 될 것이다.

객체지향 세계는 모든 객체는 자신 상태 스스로 관리하는 자율적 존재이다
( 음료 양을 줄이는 것은 음료 자신이어야 함 )

엘리스가 자신의 상태를 변경한다 +
자신이 먹은 양만큼 음료 양을 줄여달라고 메시지 전송한다
-> 음료 양을 줄이는 것은 메시지 수신한 음료가 결정할 사항

```
drinkBeverage() -> 엘리스 -> druken(quality) -> 음료
```

두 메시지를 보고 엘리스의 키가 줄어든다거나 음료의 양이 줄어든다는 상태 변경을 예측할 수 있는가? ❌

-> 메시지 송신자는 메시지 수신자의 상태 변경에 대해 전혀 알지 못한다

=> 상태를 외부에 노출시키지 않고 , 행동을 경계로 캡슐화 하는 것은 객체의 자율성을 높인다!

자율적인 객체는 스스로 판단 + 스스로 결정 하기에 객체의 지능 역시 높아진다!
-> 높아질수록 협력은 유연하고 간결해진다
##### 식별자

객체는 결국 인간의 인지 능력을 이용해 식별 가능 경계를 가진 모든 사물을 뜻함
-> 서로 구별 가능한 특정 프로퍼티가 객체 안에 존재한다는 의미!

이런 프로퍼티를 <span style="color:#00b0f0">식별자</span>
이런 식별자를 통해서 객체를 구별 가능하다

- 모든 객체는 식별자를 가지며 , 식별자를 이용해 구별이 가능하다
	-> 객체가 아닌 단순한 값은 식별자를 가지지 않는다는 것

값은 변하지 않는 양을 모델링 - VO
- 상태가 변하지 않기에 불변 상태 ( immutable state ) 를 가진다고 말함
- 값은 두 인스턴스 상태가 같다면 서로 같은 것으로 판단 
( 1 과 1이 다른가? )

값은 상태가 같은지를 이용해 판단한다

값의 상태가 같으면 두 인스턴스는 동일
상태가 다르면 다른 것으로 판단
=> 상태를 이용해 두 값이 같은지 판단할 수 있는 성질을 <span style="color:#00b0f0">동등성</span> 

객체는 시간에 따라 변경되는 상태 포함 , 행동 통해 상태를 변경
-> 객체는 가변 상태 ( mutable state ) 를 가진다

타입이 같은 두 객체의 상태가 완전히 똑같더라도 , 이들은 독립적인 별개의 객체
( 이름 과 키가 같다고 동일한 인격체인가? )

객체가 상태가 다르더라도 , 식별자가 같으면 두 객체를 같은 객체로 판단 가능하다
=> 식별자를 기반으로 객체가 같은지를 판단할 수 있는 성질을 <span style="color:#00b0f0">동일성</span> 

( 상태는 시간 흐름에 따라 변하기 때문에 동일성 판단을 할 수 없다 )

> 식별자는 어떤 객체 다른 객체를 구분하는데 사용하는 객체의 프로퍼티
> 상태는 변경될 수 있기 때문에 식별자를 이용해 동일성 검사를 통해 비교해야 한다

---

객체 지향 언어 관점에서 값 , 객체 두개는 결국 클래스로부터 생성된 객체

- 참조 객체 , 엔티티 : 식별자를 지닌 전통적 의미의 객체 가르키는 용어

- 값 객체 : 식별자를 가지지 않는 값
##### 기계로서의 객체

결국 주된 업무는 객체의 상태를 조회하고 , 객체의 상태를 변경하는 것

객체의 상태를 조회하는 작업을 <span style="color:#fb3c3c">쿼리</span> 
객체의 상태를 변경하는 작업을 <span style="color:#00b0f0">명령</span> 

둥근 버튼을 눌러서 상태 조회
사각형 버튼을 눌러서 상태 변경

=> 매우 명확 ( 누가 기계 내부를 열어서 사용하는가? )

객체가 제공하는 인터페이스를 통해서만 객체에 접근 가능

링크를 통해 연결된 두 객체가 메시지 전송을 통해 협력하고 있는 것

---
#### 행동이 상태를 결정하게 하자

쉽게 빠지는 함정은 상태를 중심으로 객체를 바라보는 것

EX) 객체가 필요한 상태가 무엇인지 결정 후 , 상태에 필요한 행동 결정

```
앨리스 객체에 필요한 상태를 먼저 찾음
-> 키와 위치를 앨리스에 추가
-> 키와 위치를 변경하거나 조회할 수 있는 행동이 무엇인지 고민
```
=> 이런 방법은 설계에 영향을 끼친다

1. 상태를 먼저 결정할 시 캡슐화가 저해된다
상태가 객체 내부로 깔끔히 캡슐화 되지 못하고 , 공용 인터페이스에 그대로 노출될 확률이 높아진다

2. 객체를 협력자가 아닌 고립된 섬으로 만든다
애플리케이션 문맥 내에 다른 객체와 협력하기 위해서 객체는 존재하는 것
-> 문맥에서 멀리 벗어난 채 객체를 설계해 자연스럽게 협력에 적합하지 못한 객체를 창조한다

3. 객체 재사용성 저하
객체 재사용성은 다양한 협력에 참여할 수 있는 능력에서 나옴
-> 상태 & 초점 맞춘 객체는 다양한 협력에 참여하기 어렵기 때문에 재사용성 저하

결국 객체의 적합성을 결정하는 것은 상태가 아닌 객체의 행동이다
#### 은유와 객체

객체지향을 현실 세계의 모방이라 보는 관점은
현실 세계에 존재하는 다양한 객체 모방 후 필요한 부분만 취해 , SW 객체로 구현하는 과정이라 생각한다

-> 객체지향 세계는 현실 세계의 단순한 모방이 아니다
( 계속 말하듯 , 객체는 자기가 스스로 역활을 해야 한다 -> 현실 세계의 상품이 할 수 있는가..? )
##### 의인화

결국 가장 큰 차이점은
현실 에선 수동적인 존재이더라도 소프트웨어 객체로 구현될 떄는 능동적으로 변한다는 것이다

-> 창조하는 객체에 현실 세계 객체와 다른 특징을 부여하는 것이 일반적
( 트럼프 카드가 스스로 뒤집을 수 있게 , 계좌가 스스로 금액을 이체할 수 있게 )

=> 현실 객체보다 더 많은 일을 할 수 있는 SW 객체 특징을 <span style="color:#00b0f0">의인화</span> 

>객체가 현실 세계 대상보다 더 많이 아는것이 모순적일 수는 있음
>그들 자신은 체계 안에서 `[능동적이고 자율적인]` 에이전트
>( 모든 생물처럼 SW는 태어나고 , 삶을 여위하고 , 죽는다 )

신화 속 인물이나 , 상상 속 동물도 필요하면 살아가도록 만들 수 있다
( 눈에 보이지 않는 공기 , 바람도 시각적 형태 가지게 표현 가능 )

현실을 모방한 게 아닌
현실 모습을 조금 참조하고 , 현실과 전혀 다른 새로운 세계를 참조해가는 것이 중요하다
( 현실 속 객체보다 더 많은 특징 & 능력 보유한 객체로 넘쳐나는게 당연함! )
###### 은유

현실 과 객체지향 세계 사이를 좀 더 설명하는 단어는 <span style="color:#00b0f0">은유</span> 이다

> 은유란 한 가지 개념을 이용해 다른 개념을 서술하는 대화의 형태이다

그 여자는 양 같아요 가 의미하는 말이?
-> 순한 양을 이용해 여자의 성격을 묘사한다

결국 현실 객체의 의미 일부가 SW 객체로 전달되므로 프로그램 내 객체도 현실 속 객체에 대한 은유이다
( 현실의 전화기 개념을 이용해 객체를 묘사하면? -> 그 객체가 전화를 걸 수 있다는 사실 )

은유는 결국 표현적 차이 or 의미적 차이라는 논점과 관련성이 깊다
=> SW에 대해 사람들이 생각하는 모습 과 SW 표현 사이 차이를 의미

은유 관계에 있는 실제 객체 이름을 SW 객체 이름을 사용하면 표현적 차이를 줄여 구조를 쉽게 에측 가능

( 그렇기에 , 현실 세계 도메인에서 사용되는 이름을 객체에 부여하라고 가이드 하는 것 )

우리의 목적은 현실을 모방하는게 아니다
-> 이상한 나라를 창조해내는 것
( 현실을 닮아아 한다는 것도 어떤 제약이나 구속도 없음을 명심하자! )
