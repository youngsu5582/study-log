# Log

## Redo Log

내구성 보장한다.
( 데이터 변경이 발생해도, 변경된 내용이 먼저 메모리 버퍼 풀에 반영되고, 동시에 Redo Log 버퍼에 기록된다. 
-> 나중에 데이터 변경 반영 )

- Crash Recovery : 서버가 갑작스럽게 종료된 경우, Redo log 를 재생(replay)해 커밋된 변경 사항 데이터 파일에 반영

### Write-Ahead Logging ( WAL )

데이터를 실제 데이터 파일 쓰기 전, 먼저 Redo Log 에 변경 사항을 기록한다.
메모리 변경 내용(Dirty Page)가 디스크 플러시되기 전에도 로그를 통해 복구가 가능하다.

### 체크포인트

일정 시점마다 InnoDB는 체크포인트 작업 수행하여 Redo log 내용을 데이터 파일에 동기화
과정 통해 Redo Log 파일 크기를 관리하고, 복구 시점 범위를 줄임

-> 서버 재시작 후 체크포인트 이후 Redo Log 항목을 재생해 데이터 무결성을 보장시킨다.

## Undo Log

롤백 및 MVCC를 위해 사용한다.

- 롤백 지원 : 트랜잭션 실행 중 발생한 변경 이전 값을 Undo Log에 기록해, 트랜잭션이 실패하거나 롤백 요청 있을 때 이전 상태로 되돌린다.
- MVCC : InnoDB는 Undo Log 를 활용해 과거 데이터 버전 유지해, 다른 트랜잭션도 일관된 스냅샷 읽도록 지원

1. 데이터 수정 전 백업 : 트랜잭션이 데이터 변경하기 전, 해당 데이터 기존 값을 Undo Log에 기록
2. 롤백 시 활용 : 트랜잭션 롤백되면, Undo Log 에 기록된 이전 값으로 데이터 복구
3. MVCC 지원 : 동시 여러 트랜잭션 실행 시, Undo Log 에 저장된 이전 데이터 버전 사용해, 각 트랜잭션 일관된 데이터 읽는다.

장기적인 실행 트랜잭션이 있더라도, 다른 트랜잭션은 Undo Log 에 보관된 과거 버전 읽어 일관된 조회 결과를 제공

## Binary Log

데이터 변경 기록과 복제를 위해 사용한다.

- 데이터 변경 기록 : DB의 모든 변경(INSERT,UPDATE,DELETE)과 DDL(테이블 생성, 변경) 명령을 순차적으로 기록한다.

> 순차적을 어떻게 보장하는가?
> 변경 이벤트가 항상 파일 끝에 추가된다. - append-only
> 여러 트랜잭션이 동시에 커밋되더라도 파일 내 순차적 저장 - 원자적으로 처리
> 각 트랜잭션이 커밋될 떄, 전역적 순서 정하고 고유 LSN 부여 - 커밋 순서 명확하게 식별
> 내부적으로 동기화, 글로벌 락 or mutex 사용해 서로 간섭하지 않고 순서대로 기록을 제어한다.

- Replication : Master-Slave 복제 환경에서, 마스터 서버 변경 사항을 바이너리 로그를 통해 슬레이브 서버로 전파 - 요새는, GTID 

- Point-In-Time Recovery : 백업 이후 변경 사항을 바이너리 로그를 이용해 재현할 수 있으므로, 특정 시점으로 복구가 가능하다.

- 감사 모니터링 : 모든 데이터는 변경 기록이 남으므로, 감사하거나 분서에도 사용 가능하다.
``
